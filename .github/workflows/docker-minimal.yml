name: Docker Minimal Image CI

on:
  push:
    branches: [ "main" ]
    tags: [ "v*.*.*" ]
    paths:
      - 'Dockerfile'
      - '.github/workflows/docker-minimal.yml'
  pull_request:
    types: [closed]
    branches: [ "main" ]
    paths:
      - 'Dockerfile'
      - '.github/workflows/docker-minimal.yml'
  release:
    types: [published]

jobs:
  build:
    uses: ./.github/workflows/common.yml
    with:
      image-suffix: minimal
      dockerfile: Dockerfile
      target: minimal
      cache-scope: minimal